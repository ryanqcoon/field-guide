<!doctype html>
<html lang="en">
  <head>
    {% include header.html %}
  </head>
  <body>
    {% include skippy.html %}

    {% include navbar.html %}

    <div class="container-fluid">
      <div class="row flex-xl-nowrap">
        <div class="col-12 col-md-3 col-lg-2 bd-sidebar d-print-none">
          {% include sidebar.html %}
        </div>

        {%- capture augmented_content -%}
          {{ content }}
          {%- assign content_pages = site.pages | where_exp: "page","page.layout != 'redirect'" -%}
          {%- for section in site.data.nav -%}
            {%- assign section_slug = section.title | slugify -%}
            {%- capture section_url -%}
              {{ site.baseurl }}/{{ section_slug }}/
            {%- endcapture -%}
            {%- assign section_page = content_pages | where: "url",section_url | first -%}

            <h2 id="{{ section_slug }}">
              {%- if section_page == nil -%}
                {{ section.title }}
              {%- else -%}
                <a href="{{ section_url }}">
                  {{ section.title }}
                </a>
              {%- endif -%}
            </h2>
            {%- if section_page.description -%}
              <p>{{ section_page.description | smartify }}</p>
            {%- endif -%}

            {% unless section.pages == nil %}
            {%- for group in section.pages -%}
              {%- assign group_slug = group.title | slugify -%}
              {%- capture group_url -%}
                {{ site.baseurl }}/{{ section_slug }}/{{ group_slug }}/
              {%- endcapture -%}
              {%- assign group_page = content_pages | where: "url",group_url | first -%}

              <h3 id="{{ section_slug }}--{{ group_slug }}">
                {%- if group_page == nil -%}
                  {{ group.title }}
                {%- else -%}
                  <a href="{{ group_url }}">
                    {{ group.title }}
                  </a>
                {%- endif -%}
              </h3>
              {%- if group_page.description -%}
                <p>{{ group_page.description | smartify }}</p>
              {%- endif -%}

              {% unless group.pages == nil %}
              <ul>
                {%- for doc in group.pages -%}
                  {%- assign doc_slug = doc.title | slugify -%}
                  {%- capture doc_url -%}
                    {{ site.baseurl }}/{{ section_slug }}/{{ group_slug }}/{{ doc_slug }}/
                  {%- endcapture -%}
                  {%- assign doc_page = content_pages | where: "url",doc_url | first -%}

                  <h4 id="{{ section_slug }}--{{ group_slug }}--{{ doc_slug }}">
                    {%- if doc_page == nil -%}
                      {{ doc.title }}
                    {%- else -%}
                      <a href="{{ doc_url }}">
                        {{ doc.title }}
                      </a>
                    {%- endif -%}
                  </h4>
                  {%- if doc_page.description -%}
                    <p>{{ doc_page.description | smartify }}</p>
                  {%- endif -%}

                {%- endfor -%}
              </ul>
              {% endunless %}

            {%- endfor -%}
            {% endunless %}
          {%- endfor -%}
        {%- endcapture -%}

        {% if page.toc %}
          <div class="d-none d-lg-block col-lg-3 bd-toc d-print-none ml-auto">
            {% include toc.html html=augmented_content class="section-nav" item_class="toc-entry toc-h%level%" %}
          </div>
        {% endif %}

        <main class="col-12 col-md-9 px-md-4 col-lg-7 d-print-block col-print-12 px-print-0 py-print-0 bd-content" role="main">
          {% include docs/header_print.html %}
          <h1 class="bd-title" id="content">{{ page.title | smartify }}{% if page.status %} {{ page.status }}{% endif %}</h1>
          <p class="bd-lead">{{ page.subtitle | smartify }}</p>
          {{ augmented_content }}
        </main>
      </div>
    </div>

    {% include scripts.html %}
  </body>
</html>
